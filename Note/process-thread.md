## 프로세스 
- 실행중인 프로그램

### 포그라운드 프로세스
- 사용자가 볼수 있는 공간에서 실행되는 프로세스

### 백그라운드 프로세스
- 사용자가 볼 수 없는 공간에서 실행되는 프로세스
- 사용자와 직접 상호작용이 가능하거나 상호작용하지 않고 그저 정해진 일만 수행하는 프로세스(데몬, 서비스)도 있다

## 프로세스 제어 블록(PCB)
- 모든 프로세스는 실행을 위해 CPU가 필요하다
- 하지만 CPU자원은 한정되어 있다
- 프로세스들은 돌아가며 한정된 시간 만큼만 CPU를 이용
- 타이머 인터럽트가 발생하면 차례 양보
- 빠르게 번갈아가며 수행되는 프로세스들을 관라하기 위해 사용하는 자료구조

## PCB에 담기는 대표적인 정보
- 프로세스 ID (PID): 특정 프로세스를 식별하기 위해 부여하는 고유한 번호
- 레지스터 값: 자신의 차례가 온 프로세스는 이전까지 사용한 레지스터 값을 모두 복원(프로그램 카운터, 스팩 포인터)
- 프로세스 상태: 입출력 장치를 사용하기 위해 기다리는 상태, CPU를 사용하기 위해 기다리는 상태, CPU 이용중인 상태등
- CPU 스케줄링 정보: 프로세스가 언제, 어떤 수서로 CPU를 할당 받을지에 대한 정보
- 메모리 정보: 프로세스가 어느 주소에 저장되어 있는지에 대한 정보, 페이지 테이블 정보
- 사용한 파일과 입출력 장치 정보: 할당된 입출력 장치, 사용중인 파일 정보

## 문맥 교환
- 인터럽트가 발생하면 지금까지 실행했던 정보(중간 정보)들을 백업해 두는데 이러한 중간 정보를 문맥이라고 한다
- 기존에 실행되던 프로세스의 중간정보를 백업하고 뒤이어 실행할 프로세스의 문맥은 복구(자연스럽게 실행중인 프로세스가 바뀜) 
- 새로운 프로세스 실행을 위해 문맥을 복구하는 과정이다

## 프로세스 메모리 영역
- 크게 코드 영역, 데이터 영역, 힙 영역, 스택 영역에 저장된다 

### 코드영역(텍스트 영역) (정적)
- 실행할 수 있는 코드, 기게어로 이루어진 명령어 저장
- 데이터가 아닌 CPU가 실행할 명령어가 담기기에 쓰기가 금지된 영역

### 데이터 영역 (정적)
- 잠깐 썻다가 없앨 데이터가 아닌 프로그램이 실행되는 동안 유지할 데이터 저장
- 전역 변수가 이에 해당

### 힙 영역 (동적)
- 사용자가 직접 직접 할당 할 수 잇는 저장공간
- 힙 영역에 할당했다면 반드시 반환해야 한다
- 자동으로 해주는 경우 가비지 컬렉션이라고 부른다
- 반환 안하면 메모리 누수의 원인

### 스택 영역 (동적)
- 데이터가 일시적응로 저장되는 공간
- 잠깐 쓰다가 말 값들이 저장되는 공간
- 매개 변수, 지역 변수가 이에 해당

### 힙 영역과 스택영역의 크기는 가변적
- 쉽게 스택 영역이 늘어나면 힙 영역은 줄어든다. 반대 상황도 마찬가지
- 그래서 이 두영역을 동적 할당 영역 이라고 한다

## 프로세스의 상태
- 생성 상태
 - 이제 막 메모리에 적재되어 PCB를 할당 받은 상태
 - 준비 완료 되면 준비 상태로
- 준비 상태
 - 당장이라도 CPU를 할당 받아 실행할 수 있지만 자신의 차례가 아니기에 기다리는 상태
 - 자신의 차례가 된다면 실행 상태로(디스패치) 
- 실행 상태
 - CPu를 할당 받아 실행 중인 상태
 - 할당된 시간 모두 사용시(타이머 인터럽트 발생 시) 준비 상태로 
 - 실행 도중 입출력장치를 사용하면 입출력 작업이 끌날 때까지 대기 상태로 
- 대기 상태
 - 프로세스가 실행 도중 입출력 장치를 사용하는 경우
 - 입출력 작업은 CPU에 비해 느리기 때문에 이 경우 대기 상태로 접어듬
 - 입출력 작업이 끝나면(입출력 완료 인터럽트를 받으면) 준비 상태로
- 종료 상태
 - 프로세스가 종료된 상태
 - PCB, 프로셋의 메모리 영역 정리

## 프로세스 계층 구조
- 윈도우는 프로세스를 계층적으로 관리 하지않음
- 프로세스 실행도중 (시스템 호출을 통해) 다른 프로세스 생성 가능
- 새 프로세스를 생성한 프로세스: 부모 프로세스
- 부모 프로세스에 의해 생성된 프로세스: 자식 프로세스
- 부모 프로세스와 자식 프로세스는 별개이다(서로 다른 PID를 가짐)
- 자식 프로세스는 자식 프로세스를 낳을 수 있다(반복 가능, 트리구조 느낌) 

## 프로세스 생성 기법
- 윈도우랑은 관련 없음

### 복제, 옷갈입기
- 부모 프로세스는 fork 시스템 호출을 통해 자신의 복사본을 자식 프로세스로 생성
- 자식 프로세스는 exec 시스템 호출을 통해 자신의 메모리 공간을 다른 프로그램으로 교체 
 
#### fork 시스템 호출
- 복사본(자식 프로세스) 생성
- 부모 프로세스의 자원 상속

#### exec 시스템 호출
- 메모리 공간을 새로운 프로그램으로 덮어쓰기
- 코드/데이터 영역은 실행할 프로그램 내용으로 바뀌고 나머지 영역은 초기화

## 스레드
- 프로세스를 두성하는 실행 흐름의 단위
- 하나 이상 프로새스는 하나 이상의 스레드를 가질 수 있다
- 실행 흐름(명령어의 순서와 흐름)이 하나인 프로세스를 단일 스레드 프로세스라고하고 여러개인 프로세스를 멀티 스레드 프로세스 라고한다 
- 스레드들은 프로세스의 자원을 공유하며 실행된다
- CPU에 처리해야될 작업을 전달할때 프로세스를 통쨰로 전달하기 보다는 스레드 단위로 CPU를 할당받아 사용한다

## 스레드의 구성 요소
- 스레드 ID 프로그램 카운터를 비롯한 레지스터 값, 스택 등
- 실행에 필요한 최소한의 정보

## 멀티 프로세스와 멀티 스레드의 차이점
- 프로세스 끼리는 자원을 공유 하지않지만 스레드는 서로 자원을 공유한다
- 멀티 프로세스는 안정성이 높고 하나의 프로세스가 죽더라도 다른 프로세스는 계속해서 동작할 수 있다
- 멀티 스레드는 하나의 프로세스 내에서 여러 개의 스레드를 생성하고, 이들은 같은 메모리 공간을 공유하므로 프로세스가 죽으면 전부 같이 죽어버린다
- 스레드는 프로세스의 자원을 공유 하기 때문에 협력과 통신에 유리하다. 멀티 프로세스는 반대

















